<!DOCTYPE html>
<html>

	<head>
		<title>Orbit - Retrieve the OAuth token</title>
	</head>

	<body>
		<script>
			window.onload = async () => {
				const fragment = window.location.hash.substring(1).split('&').map((v) => v.split('=')).reduce((pre, [key, value]) => ({ ...pre, [key]: value }), {});

				if (localStorage.getItem('stateParameter') !== atob(decodeURIComponent(fragment.state))) return window.location.replace('https://maikdevries.com/orbit/csrf');

				localStorage.setItem('accessToken', fragment.access_token);
				localStorage.setItem('tokenType', fragment.token_type);

				window.location.replace('https://maikdevries.com/orbit');
			}
		</script>
	</body>

</html>
